import sys
from joblib import dump, load
import json
import numpy as np
import pandas as pd

cols = [
    'participant_1_attack', 'participant_1_defense', 'participant_1_magic', 'participant_1_difficulty', 'participant_1_hp', 'participant_1_hpperlevel', 'participant_1_mp', 'participant_1_mpperlevel', 'participant_1_movespeed', 'participant_1_armor', 'participant_1_armorperlevel', 'participant_1_spellblock', 'participant_1_spellblockperlevel', 'participant_1_attackrange', 'participant_1_hpregen', 'participant_1_hpregenperlevel', 'participant_1_mpregen', 'participant_1_mpregenperlevel', 'participant_1_crit', 'participant_1_critperlevel', 'participant_1_attackdamage', 'participant_1_attackdamageperlevel', 'participant_1_attackspeedperlevel', 'participant_1_attackspeed', 'participant_1_average_frequency_TOP', 'participant_1_average_frequency_JUNGLE', 'participant_1_average_frequency_MIDDLE', 'participant_1_average_frequency_BOTTOM', 'participant_1_average_frequency_UTILITY', 'participant_1_average_wins_TOP', 'participant_1_average_wins_JUNGLE', 'participant_1_average_wins_MIDDLE', 'participant_1_average_wins_BOTTOM', 'participant_1_average_wins_UTILITY', 'participant_1_average_assists', 'participant_1_average_detectorWardsPlaced', 'participant_1_average_dragonKills', 'participant_1_average_goldEarned', 'participant_1_average_kills', 'participant_1_average_deaths', 'participant_1_average_magicDamageDealtToChampions', 'participant_1_average_physicalDamageDealtToChampions', 'participant_1_average_physicalDamageTaken', 'participant_1_average_magicDamageTaken', 'participant_1_average_timeCCingOthers', 'participant_1_average_totalDamageDealtToChampions', 'participant_1_average_totalDamageShieldedOnTeammates', 'participant_1_average_totalDamageTaken', 'participant_1_average_totalHeal', 'participant_1_average_visionScore', 'participant_1_average_win', 'participant_1_average_damagePerMinute', 'participant_1_average_effectiveHealAndShielding', 'participant_1_Tank', 'participant_1_Fighter', 'participant_1_Assassin', 'participant_1_Mage', 'participant_1_Support', 'participant_1_Marksman', 'participant_2_attack', 'participant_2_defense', 'participant_2_magic', 'participant_2_difficulty', 'participant_2_hp', 'participant_2_hpperlevel', 'participant_2_mp', 'participant_2_mpperlevel', 'participant_2_movespeed', 'participant_2_armor', 'participant_2_armorperlevel', 'participant_2_spellblock', 'participant_2_spellblockperlevel', 'participant_2_attackrange', 'participant_2_hpregen', 'participant_2_hpregenperlevel', 'participant_2_mpregen', 'participant_2_mpregenperlevel', 'participant_2_crit', 'participant_2_critperlevel', 'participant_2_attackdamage', 'participant_2_attackdamageperlevel', 'participant_2_attackspeedperlevel', 'participant_2_attackspeed', 'participant_2_average_frequency_TOP', 'participant_2_average_frequency_JUNGLE', 'participant_2_average_frequency_MIDDLE', 'participant_2_average_frequency_BOTTOM', 'participant_2_average_frequency_UTILITY', 'participant_2_average_wins_TOP', 'participant_2_average_wins_JUNGLE', 'participant_2_average_wins_MIDDLE', 'participant_2_average_wins_BOTTOM', 'participant_2_average_wins_UTILITY', 'participant_2_average_assists', 'participant_2_average_detectorWardsPlaced', 'participant_2_average_dragonKills', 'participant_2_average_goldEarned', 'participant_2_average_kills', 'participant_2_average_deaths', 'participant_2_average_magicDamageDealtToChampions', 'participant_2_average_physicalDamageDealtToChampions', 'participant_2_average_physicalDamageTaken', 'participant_2_average_magicDamageTaken', 'participant_2_average_timeCCingOthers', 'participant_2_average_totalDamageDealtToChampions', 'participant_2_average_totalDamageShieldedOnTeammates', 'participant_2_average_totalDamageTaken', 'participant_2_average_totalHeal', 'participant_2_average_visionScore', 'participant_2_average_win', 'participant_2_average_damagePerMinute', 'participant_2_average_effectiveHealAndShielding', 'participant_2_Tank', 'participant_2_Fighter', 'participant_2_Assassin', 'participant_2_Mage', 'participant_2_Support', 'participant_2_Marksman', 'participant_3_attack', 'participant_3_defense', 'participant_3_magic', 'participant_3_difficulty', 'participant_3_hp', 'participant_3_hpperlevel', 'participant_3_mp', 'participant_3_mpperlevel', 'participant_3_movespeed', 'participant_3_armor', 'participant_3_armorperlevel', 'participant_3_spellblock', 'participant_3_spellblockperlevel', 'participant_3_attackrange', 'participant_3_hpregen', 'participant_3_hpregenperlevel', 'participant_3_mpregen', 'participant_3_mpregenperlevel', 'participant_3_crit', 'participant_3_critperlevel', 'participant_3_attackdamage', 'participant_3_attackdamageperlevel', 'participant_3_attackspeedperlevel', 'participant_3_attackspeed', 'participant_3_average_frequency_TOP', 'participant_3_average_frequency_JUNGLE', 'participant_3_average_frequency_MIDDLE', 'participant_3_average_frequency_BOTTOM', 'participant_3_average_frequency_UTILITY', 'participant_3_average_wins_TOP', 'participant_3_average_wins_JUNGLE', 'participant_3_average_wins_MIDDLE', 'participant_3_average_wins_BOTTOM', 'participant_3_average_wins_UTILITY', 'participant_3_average_assists', 'participant_3_average_detectorWardsPlaced', 'participant_3_average_dragonKills', 'participant_3_average_goldEarned', 'participant_3_average_kills', 'participant_3_average_deaths', 'participant_3_average_magicDamageDealtToChampions', 'participant_3_average_physicalDamageDealtToChampions', 'participant_3_average_physicalDamageTaken', 'participant_3_average_magicDamageTaken', 'participant_3_average_timeCCingOthers', 'participant_3_average_totalDamageDealtToChampions', 'participant_3_average_totalDamageShieldedOnTeammates', 'participant_3_average_totalDamageTaken', 'participant_3_average_totalHeal', 'participant_3_average_visionScore', 'participant_3_average_win', 'participant_3_average_damagePerMinute', 'participant_3_average_effectiveHealAndShielding', 'participant_3_Tank', 'participant_3_Fighter', 'participant_3_Assassin', 'participant_3_Mage', 'participant_3_Support', 'participant_3_Marksman', 'participant_4_attack', 'participant_4_defense', 'participant_4_magic', 'participant_4_difficulty', 'participant_4_hp', 'participant_4_hpperlevel', 'participant_4_mp', 'participant_4_mpperlevel', 'participant_4_movespeed', 'participant_4_armor', 'participant_4_armorperlevel', 'participant_4_spellblock', 'participant_4_spellblockperlevel', 'participant_4_attackrange', 'participant_4_hpregen', 'participant_4_hpregenperlevel', 'participant_4_mpregen', 'participant_4_mpregenperlevel', 'participant_4_crit', 'participant_4_critperlevel', 'participant_4_attackdamage', 'participant_4_attackdamageperlevel', 'participant_4_attackspeedperlevel', 'participant_4_attackspeed', 'participant_4_average_frequency_TOP', 'participant_4_average_frequency_JUNGLE', 'participant_4_average_frequency_MIDDLE', 'participant_4_average_frequency_BOTTOM', 'participant_4_average_frequency_UTILITY', 'participant_4_average_wins_TOP', 'participant_4_average_wins_JUNGLE', 'participant_4_average_wins_MIDDLE', 'participant_4_average_wins_BOTTOM', 'participant_4_average_wins_UTILITY', 'participant_4_average_assists', 'participant_4_average_detectorWardsPlaced', 'participant_4_average_dragonKills', 'participant_4_average_goldEarned', 'participant_4_average_kills', 'participant_4_average_deaths', 'participant_4_average_magicDamageDealtToChampions', 'participant_4_average_physicalDamageDealtToChampions', 'participant_4_average_physicalDamageTaken', 'participant_4_average_magicDamageTaken', 'participant_4_average_timeCCingOthers', 'participant_4_average_totalDamageDealtToChampions', 'participant_4_average_totalDamageShieldedOnTeammates', 'participant_4_average_totalDamageTaken', 'participant_4_average_totalHeal', 'participant_4_average_visionScore', 'participant_4_average_win', 'participant_4_average_damagePerMinute', 'participant_4_average_effectiveHealAndShielding', 'participant_4_Tank', 'participant_4_Fighter', 'participant_4_Assassin', 'participant_4_Mage', 'participant_4_Support', 'participant_4_Marksman', 'participant_5_attack', 'participant_5_defense', 'participant_5_magic', 'participant_5_difficulty', 'participant_5_hp', 'participant_5_hpperlevel', 'participant_5_mp', 'participant_5_mpperlevel', 'participant_5_movespeed', 'participant_5_armor', 'participant_5_armorperlevel', 'participant_5_spellblock', 'participant_5_spellblockperlevel', 'participant_5_attackrange', 'participant_5_hpregen', 'participant_5_hpregenperlevel', 'participant_5_mpregen', 'participant_5_mpregenperlevel', 'participant_5_crit', 'participant_5_critperlevel', 'participant_5_attackdamage', 'participant_5_attackdamageperlevel', 'participant_5_attackspeedperlevel', 'participant_5_attackspeed', 'participant_5_average_frequency_TOP', 'participant_5_average_frequency_JUNGLE', 'participant_5_average_frequency_MIDDLE', 'participant_5_average_frequency_BOTTOM', 'participant_5_average_frequency_UTILITY', 'participant_5_average_wins_TOP', 'participant_5_average_wins_JUNGLE', 'participant_5_average_wins_MIDDLE', 'participant_5_average_wins_BOTTOM', 'participant_5_average_wins_UTILITY', 'participant_5_average_assists', 'participant_5_average_detectorWardsPlaced', 'participant_5_average_dragonKills', 'participant_5_average_goldEarned', 'participant_5_average_kills', 'participant_5_average_deaths', 'participant_5_average_magicDamageDealtToChampions', 'participant_5_average_physicalDamageDealtToChampions', 'participant_5_average_physicalDamageTaken', 'participant_5_average_magicDamageTaken', 'participant_5_average_timeCCingOthers', 'participant_5_average_totalDamageDealtToChampions', 'participant_5_average_totalDamageShieldedOnTeammates', 'participant_5_average_totalDamageTaken', 'participant_5_average_totalHeal', 'participant_5_average_visionScore', 'participant_5_average_win', 'participant_5_average_damagePerMinute', 'participant_5_average_effectiveHealAndShielding', 'participant_5_Tank', 'participant_5_Fighter', 'participant_5_Assassin', 'participant_5_Mage', 'participant_5_Support', 'participant_5_Marksman', 'participant_6_attack', 'participant_6_defense', 'participant_6_magic', 'participant_6_difficulty', 'participant_6_hp', 'participant_6_hpperlevel', 'participant_6_mp', 'participant_6_mpperlevel', 'participant_6_movespeed', 'participant_6_armor', 'participant_6_armorperlevel', 'participant_6_spellblock', 'participant_6_spellblockperlevel', 'participant_6_attackrange', 'participant_6_hpregen', 'participant_6_hpregenperlevel', 'participant_6_mpregen', 'participant_6_mpregenperlevel', 'participant_6_crit', 'participant_6_critperlevel', 'participant_6_attackdamage', 'participant_6_attackdamageperlevel', 'participant_6_attackspeedperlevel', 'participant_6_attackspeed', 'participant_6_average_frequency_TOP', 'participant_6_average_frequency_JUNGLE', 'participant_6_average_frequency_MIDDLE', 'participant_6_average_frequency_BOTTOM', 'participant_6_average_frequency_UTILITY', 'participant_6_average_wins_TOP', 'participant_6_average_wins_JUNGLE', 'participant_6_average_wins_MIDDLE', 'participant_6_average_wins_BOTTOM', 'participant_6_average_wins_UTILITY', 'participant_6_average_assists', 'participant_6_average_detectorWardsPlaced', 'participant_6_average_dragonKills', 'participant_6_average_goldEarned', 'participant_6_average_kills', 'participant_6_average_deaths', 'participant_6_average_magicDamageDealtToChampions', 'participant_6_average_physicalDamageDealtToChampions', 'participant_6_average_physicalDamageTaken', 'participant_6_average_magicDamageTaken', 'participant_6_average_timeCCingOthers', 'participant_6_average_totalDamageDealtToChampions', 'participant_6_average_totalDamageShieldedOnTeammates', 'participant_6_average_totalDamageTaken', 'participant_6_average_totalHeal', 'participant_6_average_visionScore', 'participant_6_average_win', 'participant_6_average_damagePerMinute', 'participant_6_average_effectiveHealAndShielding', 'participant_6_Tank', 'participant_6_Fighter', 'participant_6_Assassin', 'participant_6_Mage', 'participant_6_Support', 'participant_6_Marksman', 'participant_7_attack', 'participant_7_defense', 'participant_7_magic', 'participant_7_difficulty', 'participant_7_hp', 'participant_7_hpperlevel', 'participant_7_mp', 'participant_7_mpperlevel', 'participant_7_movespeed', 'participant_7_armor', 'participant_7_armorperlevel', 'participant_7_spellblock', 'participant_7_spellblockperlevel', 'participant_7_attackrange', 'participant_7_hpregen', 'participant_7_hpregenperlevel', 'participant_7_mpregen', 'participant_7_mpregenperlevel', 'participant_7_crit', 'participant_7_critperlevel', 'participant_7_attackdamage', 'participant_7_attackdamageperlevel', 'participant_7_attackspeedperlevel', 'participant_7_attackspeed', 'participant_7_average_frequency_TOP', 'participant_7_average_frequency_JUNGLE', 'participant_7_average_frequency_MIDDLE', 'participant_7_average_frequency_BOTTOM', 'participant_7_average_frequency_UTILITY', 'participant_7_average_wins_TOP', 'participant_7_average_wins_JUNGLE', 'participant_7_average_wins_MIDDLE', 'participant_7_average_wins_BOTTOM', 'participant_7_average_wins_UTILITY', 'participant_7_average_assists', 'participant_7_average_detectorWardsPlaced', 'participant_7_average_dragonKills', 'participant_7_average_goldEarned', 'participant_7_average_kills', 'participant_7_average_deaths', 'participant_7_average_magicDamageDealtToChampions', 'participant_7_average_physicalDamageDealtToChampions', 'participant_7_average_physicalDamageTaken', 'participant_7_average_magicDamageTaken', 'participant_7_average_timeCCingOthers', 'participant_7_average_totalDamageDealtToChampions', 'participant_7_average_totalDamageShieldedOnTeammates', 'participant_7_average_totalDamageTaken', 'participant_7_average_totalHeal', 'participant_7_average_visionScore', 'participant_7_average_win', 'participant_7_average_damagePerMinute', 'participant_7_average_effectiveHealAndShielding', 'participant_7_Tank', 'participant_7_Fighter', 'participant_7_Assassin', 'participant_7_Mage', 'participant_7_Support', 'participant_7_Marksman', 'participant_8_attack', 'participant_8_defense', 'participant_8_magic', 'participant_8_difficulty', 'participant_8_hp', 'participant_8_hpperlevel', 'participant_8_mp', 'participant_8_mpperlevel', 'participant_8_movespeed', 'participant_8_armor', 'participant_8_armorperlevel', 'participant_8_spellblock', 'participant_8_spellblockperlevel', 'participant_8_attackrange', 'participant_8_hpregen', 'participant_8_hpregenperlevel', 'participant_8_mpregen', 'participant_8_mpregenperlevel', 'participant_8_crit', 'participant_8_critperlevel', 'participant_8_attackdamage', 'participant_8_attackdamageperlevel', 'participant_8_attackspeedperlevel', 'participant_8_attackspeed', 'participant_8_average_frequency_TOP', 'participant_8_average_frequency_JUNGLE', 'participant_8_average_frequency_MIDDLE', 'participant_8_average_frequency_BOTTOM', 'participant_8_average_frequency_UTILITY', 'participant_8_average_wins_TOP', 'participant_8_average_wins_JUNGLE', 'participant_8_average_wins_MIDDLE', 'participant_8_average_wins_BOTTOM', 'participant_8_average_wins_UTILITY', 'participant_8_average_assists', 'participant_8_average_detectorWardsPlaced', 'participant_8_average_dragonKills', 'participant_8_average_goldEarned', 'participant_8_average_kills', 'participant_8_average_deaths', 'participant_8_average_magicDamageDealtToChampions', 'participant_8_average_physicalDamageDealtToChampions', 'participant_8_average_physicalDamageTaken', 'participant_8_average_magicDamageTaken', 'participant_8_average_timeCCingOthers', 'participant_8_average_totalDamageDealtToChampions', 'participant_8_average_totalDamageShieldedOnTeammates', 'participant_8_average_totalDamageTaken', 'participant_8_average_totalHeal', 'participant_8_average_visionScore', 'participant_8_average_win', 'participant_8_average_damagePerMinute', 'participant_8_average_effectiveHealAndShielding', 'participant_8_Tank', 'participant_8_Fighter', 'participant_8_Assassin', 'participant_8_Mage', 'participant_8_Support', 'participant_8_Marksman', 'participant_9_attack', 'participant_9_defense', 'participant_9_magic', 'participant_9_difficulty', 'participant_9_hp', 'participant_9_hpperlevel', 'participant_9_mp', 'participant_9_mpperlevel', 'participant_9_movespeed', 'participant_9_armor', 'participant_9_armorperlevel', 'participant_9_spellblock', 'participant_9_spellblockperlevel', 'participant_9_attackrange', 'participant_9_hpregen', 'participant_9_hpregenperlevel', 'participant_9_mpregen', 'participant_9_mpregenperlevel', 'participant_9_crit', 'participant_9_critperlevel', 'participant_9_attackdamage', 'participant_9_attackdamageperlevel', 'participant_9_attackspeedperlevel', 'participant_9_attackspeed', 'participant_9_average_frequency_TOP', 'participant_9_average_frequency_JUNGLE', 'participant_9_average_frequency_MIDDLE', 'participant_9_average_frequency_BOTTOM', 'participant_9_average_frequency_UTILITY', 'participant_9_average_wins_TOP', 'participant_9_average_wins_JUNGLE', 'participant_9_average_wins_MIDDLE', 'participant_9_average_wins_BOTTOM', 'participant_9_average_wins_UTILITY', 'participant_9_average_assists', 'participant_9_average_detectorWardsPlaced', 'participant_9_average_dragonKills', 'participant_9_average_goldEarned', 'participant_9_average_kills', 'participant_9_average_deaths', 'participant_9_average_magicDamageDealtToChampions', 'participant_9_average_physicalDamageDealtToChampions', 'participant_9_average_physicalDamageTaken', 'participant_9_average_magicDamageTaken', 'participant_9_average_timeCCingOthers', 'participant_9_average_totalDamageDealtToChampions', 'participant_9_average_totalDamageShieldedOnTeammates', 'participant_9_average_totalDamageTaken', 'participant_9_average_totalHeal', 'participant_9_average_visionScore', 'participant_9_average_win', 'participant_9_average_damagePerMinute', 'participant_9_average_effectiveHealAndShielding', 'participant_9_Tank', 'participant_9_Fighter', 'participant_9_Assassin', 'participant_9_Mage', 'participant_9_Support', 'participant_9_Marksman', 'participant_10_attack', 'participant_10_defense', 'participant_10_magic', 'participant_10_difficulty', 'participant_10_hp', 'participant_10_hpperlevel', 'participant_10_mp', 'participant_10_mpperlevel', 'participant_10_movespeed', 'participant_10_armor', 'participant_10_armorperlevel', 'participant_10_spellblock', 'participant_10_spellblockperlevel', 'participant_10_attackrange', 'participant_10_hpregen', 'participant_10_hpregenperlevel', 'participant_10_mpregen', 'participant_10_mpregenperlevel', 'participant_10_crit', 'participant_10_critperlevel', 'participant_10_attackdamage', 'participant_10_attackdamageperlevel', 'participant_10_attackspeedperlevel', 'participant_10_attackspeed', 'participant_10_average_frequency_TOP', 'participant_10_average_frequency_JUNGLE', 'participant_10_average_frequency_MIDDLE', 'participant_10_average_frequency_BOTTOM', 'participant_10_average_frequency_UTILITY', 'participant_10_average_wins_TOP', 'participant_10_average_wins_JUNGLE', 'participant_10_average_wins_MIDDLE', 'participant_10_average_wins_BOTTOM', 'participant_10_average_wins_UTILITY', 'participant_10_average_assists', 'participant_10_average_detectorWardsPlaced', 'participant_10_average_dragonKills', 'participant_10_average_goldEarned', 'participant_10_average_kills', 'participant_10_average_deaths', 'participant_10_average_magicDamageDealtToChampions', 'participant_10_average_physicalDamageDealtToChampions', 'participant_10_average_physicalDamageTaken', 'participant_10_average_magicDamageTaken', 'participant_10_average_timeCCingOthers', 'participant_10_average_totalDamageDealtToChampions', 'participant_10_average_totalDamageShieldedOnTeammates', 'participant_10_average_totalDamageTaken', 'participant_10_average_totalHeal', 'participant_10_average_visionScore', 'participant_10_average_win', 'participant_10_average_damagePerMinute', 'participant_10_average_effectiveHealAndShielding', 'participant_10_Tank', 'participant_10_Fighter', 'participant_10_Assassin', 'participant_10_Mage', 'participant_10_Support', 'participant_10_Marksman'
]

# def dropDesiredColumns(x):
#     cols = []
#     for col in x.columns:
#         if "average" in col or "_average_wins_" in col or "crit" in col:
#             cols.append(col)
#     return x.drop(cols, axis=1)

if len(sys.argv) == 2:
    input_data_js = json.loads(sys.argv[1])
    input_data = np.array(list(input_data_js.values()))
    tier = input_data[0]
    input_data = input_data[1:]
    # print(f"input data {input_data}")
    clf = load("./models/" + tier.upper() + '_gbc.joblib')

    # df = pd.DataFrame([input_data], columns=cols)
    # df = dropDesiredColumns(df)

    win = clf.predict_proba([input_data])[0]
    # print(win)
    # sys.stdout.flush()
    win_js = {"win" : win[0]}
    
    # print(clf.predict_proba(input_data), file=sys.stderr)
    # sys.stderr.flush()
    print(json.dumps(win_js, indent=4))
    sys.stdout.flush()
else:
    print(" ")
    sys.stdout.flush()
